<% @count = 0 %>

<h1>Users <span class="teal">Profile</span></h1>
<div class="blueback">

<div class="box"><%= link_to "Sleep", :action => "sleep" %></div>
	<h3>Number of Users:</h3>
	<%= @size %>
<h3>Growth Overall:</h3>	
<div class="chart"><img  src="<%= users_chart_url %>" /></div>
<div class="clearer"><br /></div>
<h3>Growth Today:</h3>
<div class="chart"><img  src="<%= users_hours_chart_url %>" /></div>


<div class="clearer"><br /></div>
</div>
	<%= render :partial => "partials/aggregate.html.erb" %>
<h1>User <span class="teal">Profiles</span></h1>
<div class="blueback">

	
<table>
  <tr>
    <th>Username</th>
    <th>Twitter</th>
    <th>Realname</th>
    <th>Location</th>

    <th># of sleeps</th>
	<th>Last Login</th>
	<th>Latest Sleep</th>
  </tr>

<% for user in @users %>
<% @count+=1 %>
<% if @count%2 == 0 %>
  <tr>
<% else %>
  <tr class="zebra">
<% end %>
    <td><%= link_to h(user.username), :action => "edit", :params => { :id => user.id }   %></td>
    <td>
	<% if user.twitter.length > 0 %>
		<%=link_to "@" + user.twitter.to_s, "http://www.twitter.com/" + user.twitter.to_s %>
	<% end %>
	</td>
    <td><%=h user.realname %></td>
    <td><%=h user.zip %></td>
	<td><% if user.num_of_sleeps < 1 
		  color="red"
		else
		  color=""
		end %>
		<span class="<%=color%>"> 
		<%= user.num_of_sleeps %>
		</span>		
	</td>
	<td><%= user.last_login_at ? user.last_login_at.strftime("%a, %m/%d/%y %I:%M%p") : "" %></td>
	<td><%= user.last_sleep_at ? user.last_sleep_at.strftime("%a, %m/%d/%y %I:%M%p") : "" %></td>
  </tr>
<% end %>
</table>
</div>